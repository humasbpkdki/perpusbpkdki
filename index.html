<!doctype html>
<html lang="en">

<head>
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <title>Perpustakaan BPK Perwakilan Provinsi DKI Jakarta</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
   <style>
      body {
         overflow-x: hidden;
         max-width: 100%;
         background-image: url(img/bg-perpus.jpg);
         background-size: cover;
      }

      .perpus {
         background-color: rgba(164, 25, 111, 0.304);
      }

      #berhasil {
         display: none;
         opacity: 0;
         transition: opacity 0.5s ease-in-out;
      }

      /* Animasi untuk alert diisi */
      #diisi {
         display: none;
         opacity: 0;
         transition: opacity 0.5s ease-in-out;
      }

      .perpus .row {
         height: 100vh;
      }

      .perpus form {
         background-color: rgba(0, 0, 0, 0.504);
         border-radius: 5px;
      }

      .perpus form label {
         color: white;
         font-weight: bold;
      }
   </style>
</head>

<body>
   <span class="perpus position-absolute top-0 bottom-0 end-0 start-0">
      <div class="row d-flex justify-content-center align-items-center">
         <div class="col-lg-5 col-sm-7">
            <form class="p-3 mx-2" name="form-data-keperluan-perpustakaan">
               <div class="logo mb-3 d-flex justify-content-center">
                  <img src="img/LOGO BPK PWK DKI JAKARTA - PUTIH.png" width="250" alt="Logo BPK">
               </div>
               <div class="alert alert-success" role="alert" id="berhasil">
                  Terimakasih, pesan anda sudah kami terima
               </div>
               <div class="alert alert-warning" role="alert" id="diisi">
                  Form harus diisi semua!
               </div>
               <div class="mb-3">
                  <label for="nama" class="form-label">Nama Lengkap</label>
                  <input type="text" class="form-control" id="nama" name="nama" placeholder="Masukan nama lengkap anda">
               </div>
               <div class="mb-3">
                  <label for="instansi" class="form-label">Unit Kerja/Instansi</label>
                  <select class="form-select" id="instansi" aria-label="Default select example" name="instansi">
                     <option selected disabled>Pilih Unit Kerja/Instansi</option>
                     <option value="Subbag SDM">Subbag SDM</option>
                     <option value="Subbag Umum dan TI">Subbag Umum dan TI</option>
                     <option value="Subbag Humas">Subbag Humas</option>
                     <option value="Subbag TU Kalan">Subbag TU Kalan</option>
                     <option value="Subbag Keuangan">Subbag Keuangan</option>
                     <option value="Subbag Hukum">Subbag Hukum</option>
                     <option value="Lainnya">Lainnya</option>
                  </select>
               </div>
               <div class="mb-3">
                  <label for="keperluan" class="form-label">Keperluan</label>
                  <textarea class="form-control" id="keperluan" rows="3" name="keperluan"
                     placeholder="Apa keperluan anda?"></textarea>
               </div>
               <div class="tombol-kirim d-flex justify-content-center">
                  <button type="submit" class="btn btn-primary btn-kirim" style="width: 200px;"><i
                        class="bi bi-send-fill"></i> Kirim pesan</button>
                  <button class="btn btn-primary mx-2 btn-loading d-none" style="width: 200px;" type="button" disabled>
                     <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                     Tunggu...
                  </button>
               </div>
            </form>
         </div>
      </div>
   </span>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous">
   </script>
   <script>
      // Form Data Keperluan Perpustakaan
      const scriptURL =
         'https://script.google.com/macros/s/AKfycbyV6MD2C3JazUQ4G5iat4DfPumCAiqXFNTw2zSl354xKtRmX0kiNYX6MZ0Wh6_48v1reg/exec';
      const form = document.forms['form-data-keperluan-perpustakaan'];
      const btnKirim = document.querySelector('.btn-kirim');
      const btnLoading = document.querySelector('.btn-loading');
      const alertBerhasil = document.getElementById('berhasil');
      const alertDiisi = document.getElementById('diisi');

      form.addEventListener('submit', e => {
         e.preventDefault();

         // Periksa apakah ada inputan yang belum diisi
         let isFormValid = true;

         const namaInput = form.querySelector('#nama');
         const instansiInput = form.querySelector('#instansi');
         const keperluanInput = form.querySelector('#keperluan');

         if (namaInput.value.trim() === '' || instansiInput.value.trim() === '' || keperluanInput.value.trim() ===
            '') {
            isFormValid = false;
         }

         if (isFormValid) {
            btnLoading.classList.toggle('d-none');
            btnKirim.classList.toggle('d-none');
            fetch(scriptURL, {
                  method: 'POST',
                  body: new FormData(form),
               })
               .then(response => {
                  btnLoading.classList.toggle('d-none');
                  btnKirim.classList.toggle('d-none');
                  form.reset();
                  console.log('Success!', response);

                  // Tampilkan alert berhasil dengan animasi
                  alertBerhasil.style.display = 'block';
                  setTimeout(function () {
                     alertBerhasil.style.opacity = '1';
                  }, 10);

                  // Sembunyikan alert berhasil dengan animasi setelah 4 detik
                  setTimeout(function () {
                     alertBerhasil.style.opacity = '0';
                     setTimeout(function () {
                        alertBerhasil.style.display = 'none';
                     }, 500);
                  }, 4000);
               })
               .catch(error => {
                  console.error('Error!', error.message);
               });
         } else {
            // Tampilkan alert diisi dengan animasi jika ada inputan yang belum diisi
            alertDiisi.style.display = 'block';
            setTimeout(function () {
               alertDiisi.style.opacity = '1';
            }, 10);

            // Sembunyikan alert diisi dengan animasi setelah 4 detik
            setTimeout(function () {
               alertDiisi.style.opacity = '0';
               setTimeout(function () {
                  alertDiisi.style.display = 'none';
               }, 500); // Waktu sesuai dengan durasi transisi CSS (0.5 detik)
            }, 4000); 
         }
      });
   </script>
</body>

</html>